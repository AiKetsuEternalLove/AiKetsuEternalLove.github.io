<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>FAQ</title>
  <link href="css/stylefaq.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.css'>
  <link rel='stylesheet prefetch' href='https://use.fontawesome.com/releases/v5.0.13/css/all.css'>
  <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/prism/1.14.0/themes/prism.min.css'>
  <link rel="stylesheet" href="css/cheatsheet.css">
  <script src="js/jquery.js"></script>
  <script src="js/login.js"></script>
</head>

<body>
  <nav class="navbar has-shadow" role="navigation" aria-label="main navigation">
      <div class="container">
          <div class="navbar-brand">
              <div>
                  <img src="http://nlsschool.com/assets/logo-withLabel.png" width="100" height="100">
              </div>

              <a role="button" class="navbar-burger" id="menu-toggle" data-target="#navMenu" aria-label="menu" aria-expanded="false">
                  <span aria-hidden="true"></span>
                  <span aria-hidden="true"></span>
                  <span aria-hidden="true"></span>
              </a>
          </div>

          <div class="navbar-menu" id="navMenu">
              <div class="navbar-end">
                  <div class="is-hidden-desktop">
                      <a class="navbar-item" href="administration.html">Administrasi</a>
                      <a class="navbar-item" href="discussion.html">Discussion</a>
                      <a class="navbar-item" href="classforum.html">Class Forum</a>
                      <a class="navbar-item" href="detail_jadwal.html">Schedule</a>
                      <a class="navbar-item" href="raporOnline.html">Report</a>
                      <a class="navbar-item" href="absensi.html">Attendance</a>
                      <a class="navbar-item is-active" href="faqbaru.html">FAQ</a>
                  </div>

                  <div class="navbar-item has-dropdown" id="accountMenu">
                      <a class="navbar-link" id="name"></a>

                      <div class="navbar-dropdown">
                          <a class="navbar-item" onclick="logout()">Logout</a>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </nav>

  <section class="section">
    <div class="container">
      <div class="columns">
        <div class="column is-3">
          <aside class="is-medium menu">
            <p class="menu-label">
              categories
            </p>
            <ul class="menu-list">
              <li class="is-right"><a href="#Fasilitas" class="is-active"></i>Facilities</a></li>
              <li><a href="#Beasiswa" class="is-active"></i> Scholarship </a></li>
              <li><a href="#Lain-Lain" class="is-active"></i> Etc </a></li>
            </ul>
          </aside>
        </div>
        <div class="column is-9">
          <div class="content is-medium">
            <div class="box">
              <h4 id="Fasilitas" class="title is-3">Facilities</h4>
              <article class="message is-primary">
                <span class="icon has-text-primary">
                  <i class="fas fa-question-circle"></i>
                </span>
                <div class="message-body">
                  How to make a beautiful website ?
                </div>
              </article>
              <p>Visit <a href="http://gcs.world">http://gcs.world</a></p>
            </div>
            <div class="box">
              <h4 id="Beasiswa" class="title is-3">Scholarship</h4>
              <article class="message is-primary">
                <span class="icon has-text-primary">
                  <i class="fas fa-question-circle"></i>
                </span>
                <div class="message-body">
                  How to make a beautiful website ?
                </div>
              </article>
              <p>Visit <a href="http://gcs.world">http://gcs.world</a></p>
            </div>
            <div class="box">
              <h4 id="Lain-Lain" class="title is-3">Etc</h4>
              <article class="message is-primary">
                <span class="icon has-text-primary">
                  <i class="fas fa-question-circle"></i>
                </span>
                <div class="message-body">
                  How to make a beautiful website ?
                </div>
              </article>
              <p>Visit <a href="http://gcs.world">http://gcs.world</a></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script>
    $(function() {
      $('#menu-toggle').click(function() {
        $(this).toggleClass('is-active')
        $($(this).data('target')).slideToggle(function() {
          $(this).toggleClass('is-active')
        })
      })
    })
  </script>

  <script>
      var data = ''
      getAllDiscussionFromDB()

      function respGetAllDiscussion(response) {
          data = response
          console.log(data[0].time)

          //get all discussion
          getAllDiscussion(true);
      }

      function getAllDiscussion(firstReload) {
          //shortcut.get({ _room: 'test', _type: 'discussion' }).then(function(data) {
              populateFirstPageData(data);
              //addPaginationLink(data);
              //addPagination(data);
              // });
          }


          function populateFirstPageData(x) {
              console.log(x)
              $("#list-discussion").html(" ");
              console.log(x);

              for (var i = 0; i < 99; i++) {
                  var diffTime = getDiffTime(x[i].time)
                  $("#list-discussion").append("<article class=\"media\">                    <div class=\"media-content\">                        <a href=\"detailDiscussion.html?id="+ x[i]._id +"\">                            <div class=\"content\">                               <p>                                    <strong>"+x[i].name+"</strong> <small>"+x[i].mapel+"</small> <small>"+diffTime['d']+" m</small> <small>"+diffTime['h']+" m</small> <small>"+diffTime['m']+" m</small> <small>"+diffTime['s']+" s ago</small>                                    <br>  "+x[i].msg+"                                  </p>                            </div></a>                    </div>                    <div class=\"media-right\">                        <button id=\"delete-discussion-"+x[i]._id+"\" class=\"delete\"></button>                    </div>                </article>");
                  $("#delete-discussion-"+x[i]._id).click(function() {
                      //alert($(this).attr('id').split('--', 2)[1]);
                      shortcut.del({_room: 'test', _type: 'discussion', _id: '-'+$(this).attr('id').split('--', 2)[1] })
                      .then(function(data) {
                          getAllDiscussion(false);
                          console.log(data);
                      });
                  });
              }
          }

          //shortcut.del({ _room: 'test', _type: 'discussion' });
          function getNextPage() {
              shortcut.get({ _room: 'test', _type: 'discussion' }).then(function(data) {
                  //populateFirstPageData(data);
                  getAllDiscussion(false);
                  console.log();
              });
          }

          function addPagination(x) {
              //limit per halaman = 3 discussion
              var pagination = Math.ceil(x.length / 3);
              $(".pagination-list").html(" ");
              for (var i = 0; i < pagination; i++) {
                  if (i ==0 )
                  $(".pagination-list").append(" <li> <a id=\"pagination-"+i+"\" class=\"pagination-link is-current\">"+(i+1)+"</a></li>");
                  else
                  $(".pagination-list").append(" <li> <a id=\"pagination-"+i+"\" class=\"pagination-link\">"+(i+1)+"</a></li>");
              }

              addPaginationLink(x);
          }

          function addPaginationLink(x) {
              $(".pagination-link").click(function() {
                  //alert($(this).attr('id'));
                  //alert($(this).attr('id').slice(-1));
                  var page = ($(this).attr('id').slice(-1));
                  $(".pagination-link").attr('class', 'pagination-link');
                  $(this).attr('class', 'pagination-link is-current');

                  clearListDiscussion();
                  for (var i = page * 3; i < page * 3 + 3; i++) {
                      var diffTime = getDiffTime(x[i].time)
                      $("#list-discussion").append("<article class=\"media\">                    <div class=\"media-content\">                        <a href=\"detailDiscussion.html?id="+ x[i]._id +"\">                            <div class=\"content\">                               <p>                                    <strong>"+x[i].name+"</strong> <small>"+x[i].mapel+"</small> <small>"+diffTime['d']+" m</small> <small>"+diffTime['h']+" m</small> <small>"+diffTime['m']+" m</small> <small>"+diffTime['s']+" s ago</small>                                    <br>  "+x[i].msg+"                                  </p>                            </div></a>                    </div>                    <div class=\"media-right\">                        <button id=\"delete-discussion-"+x[i]._id+"\" class=\"delete\"></button>                    </div>                </article>");
                      $("#delete-discussion-"+x[i]._id).click(function() {
                          //alert($(this).attr('id').split('--', 2)[1]);
                          //shortcut.del({_room: 'test', _type: 'discussion', _id: '-'+$(this).attr('id').split('--', 2)[1] }).then(getAllDiscussion(false)).catch(console.log);
                          shortcut.del({_room: 'test', _type: 'discussion', _id: '-'+$(this).attr('id').split('--', 2)[1] })
                          .then(function(data) {
                              getAllDiscussion(false);
                              console.log(data);
                          });

                      });
                  }
              });
          }

          function clearListDiscussion() {

              $("#list-discussion").html(" ");
          }

          function clearListPagination() {

          }

          function getDiffTime(timeCreated) {
              var time = new Date(timeCreated)
              var currentTime = new Date()

              // get total seconds between the times
              var delta = Math.abs(currentTime - time) / 1000;
              console.log(delta);


              // calculate (and subtract) whole days
              var days = Math.floor(delta / 86400);
              delta -= days * 86400;
              console.log(days);


              // calculate (and subtract) whole hours
              var hours = Math.floor(delta / 3600) % 24;
              delta -= hours * 3600;
              console.log(hours);


              // calculate (and subtract) whole minutes
              var minutes = Math.floor(delta / 60) % 60;
              delta -= minutes * 60;
              console.log(minutes);


              // what's left is seconds
              var seconds = delta % 60;  // in theory the modulus is not required
              seconds = parseInt(seconds);
              console.log(seconds);


              var diffTime = new Array()
              diffTime['d'] = days;
              diffTime['h'] = hours;
              diffTime['m'] = minutes;
              diffTime['s'] = seconds;
              return diffTime;
          }

      </script>

</body>
</html>
